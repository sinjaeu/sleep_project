<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predict Sleep Quality</title>
    <link rel="stylesheet" href="../static/CSS.css">
</head>
<body>
    <form id="predictForm">
        <label for="PhysicalActivityLevel">신체 활동 정도:</label>
        <input type="number" id="PhysicalActivityLevel" name="Physical Activity Level" step="0.1" required placeholder="0.0 ~ 100.0"><br><br>

        <label for="StressLevel">스트레스 정도:</label>
        <input type="number" id="StressLevel" name="Stress Level" step="0.1" required placeholder="0.0 ~ 10.0"><br><br>

        <label for="BMICategory">BMI 범주:</label>
        <select id="BMICategory" name="BMI Category" required>
            <option value="0">저체중</option>
            <option value="1">정상</option>
            <option value="2">과체중</option>
            <option value="3">비만 이상</option>
        </select><br><br>

        <label for="HeartRate">심박수:</label>
        <input type="number" id="HeartRate" name="Heart Rate" step="0.1" required placeholder="40.0 ~ 140.0"><br><br>

        <label for="SleepDisorder">수면 장애:</label>
        <select id="SleepDisorder" name="Sleep Disorder" required>
            <option value="0">없음</option>
            <option value="1">불면증</option>
            <option value="2">수면 무호흡증</option>
        </select><br><br>

        <label for="Enough">수면이 충분한가:</label>
        <select id="Enough" name="Enough" required>
            <option value="1">네</option>
            <option value="0">아니오</option>
        </select><br><br>

        <label for="Hours">수면 시간:</label>
        <input type="number" id="Hours" name="Hours" step="0.1" required placeholder="0.0 ~ 24.0"><br><br>

        <label for="Breakfast">아침 식사 유무:</label>
        <select id="Breakfast" name="Breakfast" required>
            <option value="1">네</option>
            <option value="0">아니오</option>
        </select><br><br>

        <label for="CaffeineIntake">카페인 섭취량:</label>
        <input type="number" id="CaffeineIntake" name="Caffeine_Intake_mg" step="0.1" required placeholder="0.0 ~ 500.0"><br><br>

        <input type="button" value="Predict Sleep Quality" onclick="submitForm()">
    </form>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>예측된 수면 점수</h2>
            <p>점수: <span id="modalScore"></span></p>
            <h3>피드백</h3>
            <pre id="modalFeedback"></pre>
        </div>
    </div>

    <script>
        async function submitForm() {
            const formData = new FormData(document.getElementById('predictForm'));
            const response = await fetch('/predict', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const result = await response.json();
                document.getElementById('modalScore').innerText = result.sleep_quality_score.toFixed(2);
                document.getElementById('modalFeedback').innerText = result.feedback.join("\n");

                // Show modal
                document.getElementById('modal').style.display = 'block';
            } else {
                console.error('Error:', await response.text());
            }
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }
    </script>
</body>
</html>
